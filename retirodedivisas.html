<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="assets/img/retiro.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retiro de Divisas</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #cdd1d3bb;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
        }
        h1 {
            color: #2a3e52;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 15px;
        }
        .container {
            width: 300px;
            background: rgba(255, 255, 255, 0.3);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.466);
        }
        label {
            font-size: 1rem;
            color: #000000;
            display: block;
            margin-bottom: 6px;
            font-weight: bold;
        }
        footer {
            text-align: center;
            padding: 20px;
            font-size: 0.9rem;
            color: #fff;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            width: fit-content;
            margin: 40px auto 0;
            border: 1px solid rgb(255, 255, 255);
        }
        select, input {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 6px;
            border: 2px solid #bdc3c7;
            font-size: 0.8rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        select:focus, input:focus {
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
            outline: none;
        }
        select:hover, input:hover {
            border-color: #00ffbf;
        }
        .denomination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            width: 100%;
            border-radius: 6px;
        }
        .denomination-input-container input {
            width: 50%;
            padding: 6px;
            border-radius: 6px;
            border: 2px solid #bdc3c7;
            text-align: center;
            font-size: 0.8rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .denomination-input-container input:focus {
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
            outline: none;
        }
        .total {
            font-weight: bold;
            color: #363f47;
            text-align: center;
            margin-top: 15px;
            font-size: 1.2rem;
        }
        .error {
            border-color: #e74c3c !important;
        }
        .error-message {
            color: #e74c3c;
            font-size: 0.8rem;
            margin-top: -10px;
            margin-bottom: 10px;
        }
        .hidden {
            display: none;
        }
        .button {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s ease;
            margin: 5px;
        }
        .button:hover {
            background-color: #2980b9;
        }
        .button.print {
            background-color: #2ecc71;
        }
        .button.print:hover {
            background-color: #27ae60;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Retiro de Divisas</h1>
        <div id="date-time" style="font-size: 0.8rem; color: #003cff; margin-bottom: 10px;"></div>
        <hr style="border-color:#4d46a7;">
        <input type="text" id="user-input" placeholder="Nombre de usuario ðŸ‘¤" aria-label="Nombre de usuario" />
        <div id="user-error" class="error-message hidden">El nombre de usuario es requerido.</div>
        <hr style="border-color:#4d46a7;">
        <select id="sucursal" aria-label="Seleccione una sucursal" onchange="toggleSucursalInput()">
            <option value="">--- Seleccione una sucursal ---</option>
            <option value="ADO">ADO</option>
            <option value="COBA">COBA</option>
            <option value="OTRA">OTRA SUCURSAL</option>
        </select>
        <input type="text" id="sucursal-input" placeholder="Ingresa el nombre de otra sucursal" class="hidden" aria-label="Nombre de sucursal" />
        <div id="sucursal-error" class="error-message hidden">La sucursal es requerida.</div>
        <hr style="border-color:#4d46a7;">
        <input type="number" id="currency-key" placeholder="Clave divisa ðŸ”‘" aria-label="Clave de divisa" oninput="selectCurrencyByKey()" />
        <div id="currency-key-error" class="error-message hidden">Clave de divisa no vÃ¡lida.</div>
        <select id="currency" aria-label="Seleccione una divisa" onchange="updateCurrencyKey()">
            <option value="">--- Seleccione una divisa ---</option>
            <option value="MXN">Moneda Nacional (MXN)</option>
            <option value="USD">DÃ³lar Americano (USD)</option>
            <option value="CAD">Canada (CAD)</option>
            <option value="CHF">Suiza (CHF)</option>
            <option value="AUD">Australia (AUD)</option>
            <option value="EUR">Euro (EUR)</option>
            <option value="BRL">Brasil (BRL)</option>
            <option value="GBP">Inglaterra (GBP)</option>
            <option value="JPY">JapÃ³n (JPY)</option>
            <option value="CUP">Cuba Convertible (CUP)</option>
            <option value="MOR_USD">Morralla Americana (MOR_USD)</option>
            <option value="MOR_CAD">Morralla Canada (MOR_CAD)</option>
            <option value="MOR_EUR">Morralla Euro (MOR_EUR)</option>
            <option value="MOR_GBP">Morralla Sterlina (MOR_GBP)</option>
            <option value="ARS">Pesos Argentinos (ARS)</option>
            <option value="COP">Colombia (COP)</option>
            <option value="BZD">Belice (BZD)</option>
            <option value="CLP">Chile (CLP)</option>
            <option value="CNY">China (CNY)</option>
            <option value="DKK">Dinamarca (DKK)</option>
            <option value="GTQ">Guatemala (GTQ)</option>
            <option value="HKD">Hong Kong (HKD)</option>
            <option value="ILS">Israel (ILS)</option>
            <option value="NOK">Noruega (NOK)</option>
            <option value="PEN">PerÃº (PEN)</option>
            <option value="RUB">Rusia (RUB)</option>
            <option value="SEK">Suecia (SEK)</option>
        </select>
        <div id="denominations-container"></div>
        <div class="total" id="total">Monto total: $0.00</div>
        <button class="button print" onclick="printForm()">Imprimir</button>
    </div>
<footer style="text-align: center; margin-top: 20px; font-size: 0.9rem; color: #555;">
    Creado por Alejandro Toral ðŸš€
</footer>
</body>
    <script>
        // Datos de denominaciones por divisa
        const denominationsByCurrency = {
            MXN: [1000, 500, 200, 100, 50, 20, 10, 5, 2, 1, 0.5],
            USD: [100, 50, 20, 10, 5, 2, 1],
            CAD: [100, 50, 20, 10, 5],
            CHF: [1000, 200, 100, 50, 20, 10, 5],
            AUD: [100, 50, 20, 10, 5],
            EUR: [500, 200, 100, 50, 20, 10, 5],
            BRL: [200, 100, 50, 20, 10, 5, 2, 1],
            GBP: [50, 20, 10, 5],
            JPY: [10000, 5000, 2000, 1000],
            CUP: [100, 50, 20, 10, 5, 3, 1],
            MOR_USD: [1, 0.5, 0.25, 0.1, 0.05],
            MOR_CAD: [2, 1],
            MOR_EUR: [2, 1, 0.5],
            MOR_GBP: [2, 1],
            ARS: [1000, 500, 200, 100, 50, 20, 10, 5, 2],
            COP: [100000, 50000, 20000, 10000, 5000, 2000, 1000],
            BZD: [100, 50, 20, 10, 5, 2, 1],
            CLP: [20000, 10000, 5000, 2000, 1000],
            CNY: [100, 50, 20, 10, 5],
            DKK: [1000, 500, 200, 100, 50],
            GTQ: [200, 100, 50, 20, 10, 5],
            HKD: [1000, 500, 100, 50, 20, 10],
            ILS: [200, 100, 50, 20],
            NOK: [1000, 500, 200, 100, 50],
            PEN: [200, 100, 50, 20, 10],
            RUB: [5000, 2000, 1000, 500, 200, 100, 50, 10, 5],
            SEK: [1000, 500, 200, 100, 50, 20]
        };

        // Mapa de claves de divisa
        const currencyMap = {
            4: 'CAD', 2: 'USD', 7: 'EUR', 9: 'GBP', 8: 'BRL', 18: 'COP', 1: 'MXN', 6: 'AUD', 19: 'BZD', 20: 'CLP',
            21: 'CNY', 32: 'KRW', 33: 'CRC', 11: 'CUP', 22: 'DKK', 30: 'SCO', 23: 'GTQ', 24: 'HKD', 25: 'ILS', 10: 'JPY',
            12: 'MOR_USD', 13: 'MOR_CAD', 14: 'MOR_EUR', 15: 'MOR_GBP', 26: 'NOK', 31: 'NZD', 27: 'PEN', 17: 'ARS', 28: 'RUB',
            29: 'SEK', 5: 'CHF', 34: 'TRY'
        };

        // Actualiza la fecha y hora
        function updateDateTime() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true };
            const now = new Date().toLocaleString('es-ES', options);
            document.getElementById('date-time').textContent = now;
        }

        // Muestra u oculta el campo de sucursal
        function toggleSucursalInput() {
            const sucursalSelect = document.getElementById('sucursal');
            const sucursalInput = document.getElementById('sucursal-input');
            const sucursalError = document.getElementById('sucursal-error');

            if (sucursalSelect.value === 'OTRA') {
                sucursalInput.classList.remove('hidden');
                sucursalError.classList.add('hidden');
            } else {
                sucursalInput.classList.add('hidden');
                sucursalInput.value = "";
                sucursalError.classList.add('hidden');
            }
        }

        // Actualiza las denominaciones segÃºn la divisa seleccionada
        function updateDenominations() {
            const currency = document.getElementById('currency').value;
            const denominations = denominationsByCurrency[currency];
            const denominationsContainer = document.getElementById('denominations-container');

            denominationsContainer.innerHTML = ""; // Limpia el contenedor

            if (!denominations) return;

            denominations.forEach(denomination => {
                const row = document.createElement('div');
                row.className = 'denomination-container';

                const label = document.createElement('label');
                label.textContent = `${denomination}:`;

                const input = document.createElement('input');
                input.type = 'number';
                input.setAttribute('data-denomination', denomination);
                input.placeholder = '-';
                input.addEventListener('input', updateTotal);

                row.appendChild(label);
                row.appendChild(input);
                denominationsContainer.appendChild(row);
            });
        }

        // Calcula y actualiza el monto total
        function updateTotal() {
            let total = 0;
            const inputs = document.querySelectorAll('.denomination-container input');
            inputs.forEach(input => {
                const denomination = parseFloat(input.getAttribute('data-denomination'));
                const value = parseInt(input.value) || 0;
                total += denomination * value;
            });
            document.getElementById('total').textContent = `Monto total: ${total.toLocaleString('es-MX', { style: 'currency', currency: 'MXN' })}`;
        }

        // Selecciona la divisa por clave
        function selectCurrencyByKey() {
            const key = parseInt(document.getElementById('currency-key').value);
            const currency = currencyMap[key] || "";
            const currencyKeyInput = document.getElementById('currency-key');
            const errorMessage = document.getElementById('currency-key-error');

            if (currency) {
                document.getElementById('currency').value = currency;
                currencyKeyInput.classList.remove('error');
                errorMessage.classList.add('hidden');
                updateDenominations();
            } else {
                currencyKeyInput.classList.add('error');
                errorMessage.classList.remove('hidden');
            }
        }

        // Actualiza la clave de divisa segÃºn la selecciÃ³n
        function updateCurrencyKey() {
            const currency = document.getElementById('currency').value;
            const key = Object.keys(currencyMap).find(key => currencyMap[key] === currency);
            document.getElementById('currency-key').value = key || "";
            updateDenominations();
        }
        function validateForm() {
    let isValid = true;

    // Validar nombre de usuario
    const userInput = document.getElementById('user-input').value.trim();
    const userError = document.getElementById('user-error');
    if (userInput === "") {
        userError.classList.remove('hidden');
        isValid = false;
    } else {
        userError.classList.add('hidden');
    }

    // Validar sucursal
    const sucursalSelect = document.getElementById('sucursal').value;
    const sucursalInput = document.getElementById('sucursal-input').value.trim();
    const sucursalError = document.getElementById('sucursal-error');
    if (sucursalSelect === "") {
        sucursalError.textContent = "La sucursal es requerida.";
        sucursalError.classList.remove('hidden');
        isValid = false;
    } else if (sucursalSelect === "OTRA" && sucursalInput === "") {
        sucursalError.textContent = "El nombre de la sucursal es requerido.";
        sucursalError.classList.remove('hidden');
        isValid = false;
    } else {
        sucursalError.classList.add('hidden');
    }

    // Validar clave de divisa o divisa seleccionada
    const currencyKey = document.getElementById('currency-key').value.trim();
    const currencySelect = document.getElementById('currency').value;
    const currencyKeyError = document.getElementById('currency-key-error');
    if (currencyKey === "" && currencySelect === "") {
        currencyKeyError.textContent = "La clave de divisa o la divisa seleccionada es requerida.";
        currencyKeyError.classList.remove('hidden');
        isValid = false;
    } else {
        currencyKeyError.classList.add('hidden');
    }

    // Validar al menos una denominaciÃ³n con valor mayor a 0
    const denominationInputs = document.querySelectorAll('.denomination-container input');
    let hasValidDenomination = false;
    denominationInputs.forEach(input => {
        if (parseInt(input.value) > 0) {
            hasValidDenomination = true;
        }
    });
    if (!hasValidDenomination) {
        alert("Debe ingresar al menos una denominaciÃ³n con un valor mayor a 0.");
        isValid = false;
    }

    return isValid;
}

        // Imprime el comprobante de retiro
        function printForm() {
            if (!validateForm()) {
        return; // Detener la impresiÃ³n si hay errores
    }
            const transaction = {
                user: document.getElementById('user-input').value.trim(),
                sucursal: document.getElementById('sucursal').value === 'OTRA' ? document.getElementById('sucursal-input').value.trim() : document.getElementById('sucursal').value,
                currency: document.getElementById('currency').value,
                total: document.getElementById('total').textContent,
                dateTime: new Date().toLocaleString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true }),
                denominations: []
            };

            // Obtener las denominaciones ingresadas
            const inputs = document.querySelectorAll('.denomination-container input');
            inputs.forEach(input => {
                const denomination = parseFloat(input.getAttribute('data-denomination'));
                const value = parseInt(input.value) || 0;
                if (value > 0) {
                    transaction.denominations.push({ denomination, value });
                }
            });

            // Generar el contenido del comprobante
const printContent = `
    <div style="font-family: Arial, sans-serif; width: 80mm; padding: 5px; font-size: 12px;">
        <h1 style="text-align: center; font-size: 18px; margin: 5px 0; color: #000;">Retiro de Divisas</h1>
        
        <!-- LÃ­nea divisoria -->
        <div style="text-align: center; margin: 10px 0;">
            <hr style="border: 0; border-top: 2px dashed #000; margin: 5px 0;">
        </div>
        
        <div style="margin-bottom: 5px;">
            <p style="margin: 4px 0; font-size: 14px;"><strong>Fecha y Hora:</strong> ${transaction.dateTime}</p>
            <p style="margin: 4px 0; font-size: 14px;"><strong>Usuario:</strong> ${transaction.user}</p>
            <p style="margin: 4px 0; font-size: 14px;"><strong>Sucursal:</strong> ${transaction.sucursal}</p>
            <p style="margin: 4px 0; font-size: 14px;"><strong>Divisa:</strong> ${getCurrencyFullName(transaction.currency)}</p>
        </div>
        
        <!-- LÃ­nea divisoria -->
        <div style="text-align: center; margin: 10px 0;">
            <hr style="border: 0; border-top: 2px dashed #000; margin: 5px 0;">
        </div>
        
        <div style="margin-bottom: 5px;">
            <h3 style="font-size: 16px; margin: 5px 0; color: #000; text-align: left;">Detalle de Denominaciones:</h3>
            <ul style="list-style-type: none; padding: 0; margin: 0;">
                ${transaction.denominations.map(d => `
                    <li style="margin: 3px 0; padding: 4px; background-color: #f4f4f4; border-radius: 3px; font-size: 14px; text-align: center;">
                        ${d.value} de ${d.denomination}
                    </li>
                `).join('')}
            </ul>
        </div>
        
        <!-- LÃ­nea divisoria -->
        <div style="text-align: center; margin: 10px 0;">
            <hr style="border: 0; border-top: 2px dashed #000; margin: 5px 0;">
        </div>
        
        <div style="text-align: left; font-size: 18px; font-weight: bold; margin-top: 5px;">
            ${transaction.total}
        </div>
        
        <!-- LÃ­nea divisoria -->
        <div style="text-align: center; margin: 10px 0;">
            <hr style="border: 0; border-top: 2px dashed #000; margin: 5px 0;">
        </div>
        
        <div style="text-align: center; margin-top: 5px; font-size: 12px; color: #555;">
            <p>Desarrollado por Alejandro Toral</p>
        </div>
    </div>
`;

// FunciÃ³n para obtener el nombre completo de la divisa
function getCurrencyFullName(currencyCode) {
    const currencyNames = {
        MXN: "Moneda Nacional (MXN)",
        USD: "DÃ³lar Americano (USD)",
        CAD: "DÃ³lar Canadiense (CAD)",
        CHF: "Franco Suizo (CHF)",
        AUD: "DÃ³lar Australiano (AUD)",
        EUR: "Euro (EUR)",
        BRL: "Real BrasileÃ±o (BRL)",
        GBP: "Libra Esterlina (GBP)",
        JPY: "Yen JaponÃ©s (JPY)",
        CUP: "Peso Cubano Convertible (CUP)",
        MOR_USD: "Morralla Americana (MOR_USD)",
        MOR_CAD: "Morralla Canadiense (MOR_CAD)",
        MOR_EUR: "Morralla Euro (MOR_EUR)",
        MOR_GBP: "Morralla Libra Esterlina (MOR_GBP)",
        ARS: "Peso Argentino (ARS)",
        COP: "Peso Colombiano (COP)",
        BZD: "DÃ³lar BeliceÃ±o (BZD)",
        CLP: "Peso Chileno (CLP)",
        CNY: "Yuan Chino (CNY)",
        DKK: "Corona Danesa (DKK)",
        GTQ: "Quetzal Guatemalteco (GTQ)",
        HKD: "DÃ³lar de Hong Kong (HKD)",
        ILS: "Nuevo Shekel IsraelÃ­ (ILS)",
        NOK: "Corona Noruega (NOK)",
        PEN: "Sol Peruano (PEN)",
        RUB: "Rublo Ruso (RUB)",
        SEK: "Corona Sueca (SEK)"
    };
    return currencyNames[currencyCode] || currencyCode; // Si no se encuentra, devuelve el cÃ³digo original
}

            // Abrir una ventana de impresiÃ³n
            const printWindow = window.open('', '', 'width=600,height=600');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
            resetForm();
        }
        // FunciÃ³n para reiniciar el formulario
function resetForm() {
    document.getElementById('currency-key').value = "";
    document.getElementById('currency').value = "";
    document.getElementById('denominations-container').innerHTML = "";
    document.getElementById('total').textContent = "Monto total: $0.00";
    updateDenominations();
}

        // InicializaciÃ³n
        updateDateTime();
        setInterval(updateDateTime, 1000);
        updateDenominations();
    </script>
</body>
</html>
